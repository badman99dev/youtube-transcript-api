<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Direct RapidAPI Call Test (No Proxy)</title>
</head>
<body>
    <h1>Direct RapidAPI Web Search Tester</h1>
    <p>This will try to call RapidAPI directly from your browser.</p>
    <input type="text" id="query" value="What is today's news in America?" size="50">
    <button onclick="runSearch()">Search</button>
    <hr>
    <h2>Result:</h2>
    <pre id="result">Results will appear here...</pre>

    <script>
        async function runSearch() {
            const queryText = document.getElementById('query').value;
            const resultPre = document.getElementById('result');
            
            if (!queryText) {
                resultPre.textContent = 'Please enter a query.';
                return;
            }

            resultPre.textContent = 'Searching...';
            
            const rapidApiUrl = 'https://perplexity2.p.rapidapi.com/';
            const options = {
                method: 'POST',
                headers: {
                    // NOTE: API Key yahan browser me dikhega, jo security risk hai.
                    'x-rapidapi-key': '4ff5a91fdcmsh7ad6b6dd2d0f1a2p1c6cf9jsnc7582a9d019a',
                    'x-rapidapi-host': 'perplexity2.p.rapidapi.com',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    query: queryText
                })
            };

            try {
                const response = await fetch(rapidApiUrl, options);
                
                // Agar response OK nahi hai, to error throw karo
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                
                const data = await response.json();
                resultPre.textContent = JSON.stringify(data, null, 2);

            } catch (error) {
                console.error('THE REAL ERROR IS HERE:', error);
                resultPre.textContent = `Request failed. Check the browser console (Press F12 -> Console) for the CORS error.\n\nError message: ${error.message}`;
            }
        }
    </script>
</body>
</html>